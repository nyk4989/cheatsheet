# 脆弱性名: [IDOR/Access control vulnerabilities]  


## 1️ 概要 / 定義
- **アクセス制御とは？**
	- アクションの実行やリソースへのアクセスの制御を行う。(認証は別。)
	- Webアプリケーションの場合、アクセス制御は認証とセッション管理に依存する。
- **アクセス制御の方法**
	- [認証]:ユーザが本人であることを確認する。
	- [セッション管理]:同じユーザによって行われる後続のHTTP要求を識別する。
	- [アクセス制御]:ユーザが実行しようとしているアクションの実行が許可されるかどうかを決定する。
- **アクセス制御の種類**
	- [垂直アクセス制御]
		- 一般ユーザが管理者のみのアクションや機能の制御を行っている。
	- [水平アクセス制御]
		- 同じ権限のものの別のユーザの制御。簡単に説明すると同じ端末内のWindowsユーザ。これがWebにもある。
	- [コンテキスト依存のアクセス制御]
		- ユーザが誤った順序でアクションを実行することを防ぐ。
		- 例えばユーザが支払いを済ませた後に購入履歴を変更できないようにする。みたいな

## 2️ 攻撃の前提条件
- [攻撃が成立するために必要な前提条件]
- 例：認証済みである必要がある、特定の権限を持っている等

## 3️ 影響
- アクセス制御の脆弱性は、ユーザがリソースにアクセスしたり許可されていないアクションを実行したりできる。

## 4️ 何ができるか（攻撃成功時の具体例）
- アクセス制御の不備を利用して得た機能を使うことができる。例えば管理者ユーザの機能でユーザのパスワードリセットがあればそれができる。

## 5️ 攻撃フロー（手順化）
- [ケース1]:保護されていない機能
	- 一般の画面からはリンクがない/adminの発見
	- robots.txtでも見つかる可能性があるが、Directory Bruteやるほうが早そう。
	- 想定しにくいURLの場合もJSなどで気付かれる可能性がある。

## 6️ 検出方法（診断手法）
- 手動：
  - [具体的にどのツールを使い、どう検証するか]
- 自動：
  - [使用可能なツール名]
  - [どういう設定や条件で検出できるか]

## 7️ 判定基準
- [何をもって脆弱と判定するか]
- [ガイドライン（OWASP、CWEなど）や一般的な基準に照らして明文化]
- 例：認証なしで閲覧可能 / 特定操作が実行可能 / トークンがない 等

## 8️ 防御策 / 緩和策

## 9 Payload
---

## 【補足】理解すべき背景
- なぜこの脆弱性が成立するのか：
  - [仕様上、設計上、実装上、どの要素が原因か]
- よくある失敗事例：
  - [実際に企業や現場でありがちなミス]
- 関連する脆弱性・攻撃手法：
  - [他の脆弱性との関連性]