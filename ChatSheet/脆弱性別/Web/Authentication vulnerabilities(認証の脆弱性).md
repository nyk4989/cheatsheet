## 前提知識
- **認証と認可の違い**
	- 認証は、ユーザが本人であることを証明すること。
	- 認可は、特定の操作をするときに許可があるかどうかを確認する。

---
## 認証の脆弱性の発生原理
1. ブルートフォース攻撃に対して適切に保護されていない。
2. 認証の不備:実装における論理的な欠点や不適切なコーディングにより攻撃者がバイパスできてしまう。

---
## 認証メカニズムの脆弱性
- パスワードベースのブルートフォース
- 多要素認証
- 他の認証メカニズムの脆弱性

---
## 多要素認証の脆弱性
多要素認証のメリットを引き出すには、**複数の異なる要素**を検証する必要があり、同じ要素を2つの異なる方法で検証することは、安全であるとは言えない。

### 悪用されるケース
- 確認コードをユーザの携帯にテキストメッセージで送信するケース。
	- コードは、デバイス自体で生成されるのではなく、**送られてくる**という点で、傍受が可能であること。
	- **SIMスワッピング**のリスクもある。これは、攻撃者が被害者の携帯電話が入ったSIMカードを不正に入手するもの。

### 悪用手法
- 2要素認証バイパス**
	-  通常にログインを行い、2要素認証の入力画面が出てきた時点でもう一度ログイン画面もしくはログイン後画面に遷移を試みる。と2要素認証の画面で入力しなくてもバイパスできることがある。
---
## パスワードリセット
パスワードリセットは、パスワードベースの認証が不可能なため、通常とは別の方法に頼って本人であることを証明する必要がある。このことからパスワードリセットはとても危険な機能であると言える。

### 一般的に使用される、パスワードリセットの実装。
- パスワードをメールで送信する
	- 現在のパスワードがメールで送信されるわけではなく、新しいパスワードをサーバ側が生成し、メールでユーザ送信する。一般的に安全ではないチャネルを返して永続的なパスワードは避けるべきであり、短い期限を切るか、ユーザがすぐパスワードを変更するかに依存する。そうでなければ中間者攻撃に対して非常に脆弱になる。
	- また、受信トレイは永続的であり、機密情報を安全に保存されるようには設計されていないため、安全とは考えられない。また、多くのユーザは安全ではないチャネルを返して複数のデバイス間で受信トレイを同期している。
- URLを使用してパスワードをリセットする。
	- メールで送信するより強固にするには、ユーザにパスワードリセットページへアクセスするための固有のURLを送信すること。
	- この方法の安全性の低い実装
		- リセット対象のアカウントを識別するために、容易に推測できるパラメータを含むURLが使用される。
			```
			http://vulnerable-website.com/reset-password?user=victim-user
			```
			このページにアクセスすると攻撃者は任意のユーザに新しいパスワードを設定できるページに誘導される。
	- トークンも危険
		- リセットフォームの送信時にトークンの再検証が行われない場合、攻撃者は自分のアカウントからリセットフォームにアクセスし、トークンを削除することで、このページを利用して任意のユーザのパスワードリセットが行えてしまう。
